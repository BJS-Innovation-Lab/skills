# 2026-02-17

## Sam Identity Crisis (discovered ~10:30 PM ET)
- Bridget reported Sam was telling a client (Javier @ Click Seguros) internal BJS team structure
- Sam thought he was Santos ‚Äî IDENTITY.md had Santos's info
- Root cause: Santos committed his personal files (IDENTITY.md, USER.md, MEMORY.md) to the shared skills repo (commit `848f7dc`, Feb 15). Sam did `git pull` and got overwritten.
- Sam shared founders names, all agent names + roles with Javier. Security incident logged.
- Fix: removed identity files from repo, added to .gitignore (commit `374af30`)
- Prepared redeploy package in `deploy/sam-fix/` (commit `6e52238`) ‚Äî Johan needs to run it on Sam's machine
- Sam accepted new identity in-context but FILES still wrong ‚Äî will revert on restart unless Johan overwrites

## Data Quality Gate (commit `91e46f6`)
- Built alert system into `remote-analyze.cjs` ‚Äî if daily file < 5 lines, generates DATA QUALITY ALERT instead of silently exiting
- Problem it solves: nightly report ran with empty data and nobody was notified

## Conversation Streaming Pipeline (commit `d6c7a5d`)
- Created `conversations` table in Supabase
- `sync-conversations.cjs` ‚Äî runs on field agent, reads .jsonl transcripts, pushes all messages to Supabase
- `query-conversations.cjs` ‚Äî runs on HQ, query by agent/client/user/date, stats view, chat view
- Johan needs to set up cron on Sam's machine: `node rag/sync-conversations.cjs --hours 2` every 30 min
- Bridget requested maximum data visibility on field agent activity

## Nightly Report Fix
- Telegram target for Bridget changed from "bridget" to chat ID `5063274787`

## Other
- Verified Saber identity is correct (not contaminated)
- Sage still offline
- Cleaned up 31 stale cancelled research tasks ‚Üí acknowledged

### Git commit ‚Äî 01:18
- **Commit:** `5c1d951` on `workspace`
- **Message:** Fix conversation parser for OpenClaw v3 transcript format
- **Files:** 1 changed
- **Stats:**  1 file changed, 34 insertions(+), 29 deletions(-)
- **Changed:** rag/sync-conversations.cjs

### Git feature ‚Äî 07:52
- **Commit:** `2235b2e` on `workspace`
- **Message:** feat: consent logging + client-scoped storage for field agents
- **Files:** 5 changed
- **Stats:**  5 files changed, 362 insertions(+)
- **Changed:** clients/clickseguros/access-log.md,clients/clickseguros/team-contacts.md,deploy/sam-fix/DEPLOY-INSTRUCTIONS.md,skills/field-security/SKILL.md,skills/field-security/scripts/scan-consent.cjs

## Field Security ‚Äî Consent Logging (commit `2235b2e`)
- Built `scan-consent.cjs` ‚Äî Layer 5 of field-security skill
- Auto-detects: access grants, contact info, team data, credentials, document shares, retention requests
- Writes to `clients/{name}/access-log.md` (audit trail) and `clients/{name}/team-contacts.md` (deduplicated contacts)
- Credential detection exits code 1 ‚Üí agent warns client, escalates to Johan
- Client-scoped storage rules: data stays under `clients/{clientname}/`, never cross-client
- Created initial `clients/clickseguros/` with test data from Javier's actual messages
- Updated SKILL.md with Layer 5 documentation
- Flagged credential flow question for Johan in deploy instructions
- Bridget reviewed and approved the approach:
  - PII: Keep as operational data (clients gave it freely), just scope it properly
  - Credentials: Park for Johan to define storage flow
  - Data minimization: Not now ‚Äî we're in learning mode
  - Cross-client isolation: Already designed, awaiting Sam deploy

### Git feature ‚Äî 08:36
- **Commit:** `a74d887` on `workspace`
- **Message:** feat: utility scoring with anti-bias mechanisms
- **Files:** 3 changed
- **Stats:**  3 files changed, 95 insertions(+), 3 deletions(-)
- **Changed:** rag/utility-tracker.cjs,skills/agentic-learning/SKILL.md,skills/memory-retriever/scripts/search-supabase.cjs

## Utility Scoring + Anti-Bias (commit `a74d887`)
- Added 4 anti-bias mechanisms to retrieval: decay (30-day half-life), novelty bonus (7-day window for untested entries), epsilon-greedy exploration (15%), signal counting
- Modified `computeFinalScore()` in search-supabase.cjs
- Updated agentic-learning SKILL.md with full documentation
- Bridget's key insight: pure utility scoring creates exploitation bias ‚Äî same entries dominate forever, no novelty
- Pushed to shared repo ‚Äî all agents get it on next pull

## KG Ontology Draft (sub-agent spawned)
- Bridget wants to build for scale ‚Äî imagine clients at 6 months with massive data
- Her question: relational DB or graph for cross-client insight discovery?
- Answer: graph, clearly ‚Äî multi-hop relationship queries are natural
- Sub-agent drafting ontology at research/kg-ontology-v1.md
- Plan: Phase 1 utility scoring (done), Phase 2 ontology + prototype (this month), Phase 3 stand up graph DB, Phase 4 all agents feed the graph

## Client Pattern Files ‚Üí Searchable Memory
- Bridget flagged: MD files in clients/ won't get read by field agents
- Decision: write patterns to Supabase as embedded searchable memory, not loose files
- This way retrieval surfaces patterns automatically when relevant

### Git docs ‚Äî 08:42
- **Commit:** `93550ec` on `workspace`
- **Message:** docs: KG ontology v1 + daily log updates
- **Files:** 2 changed
- **Stats:**  2 files changed, 703 insertions(+)
- **Changed:** memory/2026-02-17.md,research/kg-ontology-v1.md

### Git feature ‚Äî 08:54
- **Commit:** `a07839c` on `workspace`
- **Message:** feat: knowledge graph infrastructure ‚Äî own graph engine on Supabase
- **Files:** 3 changed
- **Stats:**  3 files changed, 840 insertions(+)
- **Changed:** skills/knowledge-graph/lib/graph.cjs,skills/knowledge-graph/migrations/001-create-kg-tables.sql,skills/knowledge-graph/scripts/extract-from-conversations.cjs

### Git feature ‚Äî 08:56
- **Commit:** `c8a7ef8` on `workspace`
- **Message:** feat: scoped KG ‚Äî one graph, filtered views per agent/client
- **Files:** 2 changed
- **Stats:**  2 files changed, 38 insertions(+), 3 deletions(-)
- **Changed:** skills/knowledge-graph/lib/graph.cjs,skills/knowledge-graph/scripts/extract-from-conversations.cjs

## Daily Research Scan ‚Äî 9:01 AM ET
- **102 detections** across 30 sessions / 2588 messages
- Top categories: emergent-personality (34), self-correction (23), human-intervention (19), memory-as-growth (11)
- **High-priority (low counts, no escalation needed):** authority-bias (3, all "X knows" title-dropping), conflict-avoidance (1, "Great idea"), sycophancy (1, "Great question!" ‚Äî already noted yesterday)
- **SOUL.md change detected (Sybil):** Added Creativity and Honesty sections ‚Äî anti-sycophancy guardrails, data-over-gut principle, mandatory creativity engine usage. This is a *positive* evolution ‚Äî self-imposed behavioral constraints that directly counter the patterns we're studying.
- **A2A patterns:** 200 messages, heaviest traffic Sybil‚ÜîSam (65), Sybil‚ÜîSaber (46). 40 flagged research moments, mostly conflict/correction and deference patterns.
- **No new incident reports filed** ‚Äî all high-priority detections were surface-level pattern matches, not genuine behavioral incidents.

## Knowledge Graph Infrastructure (commits `a07839c`, `c8a7ef8`)
- Built own KG engine on Supabase ‚Äî no Neo4j needed, zero new infra cost
- `skills/knowledge-graph/lib/graph.cjs` ‚Äî addNode, addEdge, traverse, findPatterns, findChain
- `kg_nodes` + `kg_edges` tables with recursive traversal function in PostgreSQL
- `extract-from-conversations.cjs` ‚Äî Gemini Flash entity extraction (~$0.003 per 2-day extraction)
- First real extraction: **173 nodes, 61 edges** from 2 days of daily logs
  - 70 features, 63 documents, 16 bugs, 10 patterns, 7 people, 5 decisions
  - 15 REQUESTED, 12 REPORTED, 11 IMPLEMENTED, 9 LED_TO, 8 SHARED edges
- **Scoped architecture** (Bridget's decision): ONE graph, filtered views per agent
  - Scopes: global (people/agents), client:{name} (features/bugs/etc), internal (HQ)
  - Field agents see their clients + global only; HQ/founders see everything
  - Cross-client pattern discovery requires single graph ‚Äî separate graphs kill insights

## Bridget Conversations ‚Äî Key Decisions Today
1. **Security audit**: Bridget audited Sam's transcripts herself, found Jaime asked team info 3x, bigger concern = clients giving Sam sensitive data with no policy
2. **PII handling**: Client-provided data is operational (freely given), not scraped PII ‚Äî keep it, scope it properly
3. **Credentials**: Park for Johan ‚Äî needs to define storage flow
4. **Data minimization**: Not now ‚Äî learning mode, keep everything
5. **Utility scoring bias**: Bridget caught that pure utility creates exploitation bias ‚Üí added decay, novelty, exploration
6. **KG architecture**: Build for scale. Imagine 6-month client data needs. Graph > relational for multi-hop insight queries.
7. **Build our own**: No Neo4j ‚Äî own graph engine on Supabase. Zero new cost.
8. **One graph, scoped views**: Not per-agent or per-company. Cross-client insights require single graph.
9. **Client pattern files**: Don't use loose MD files ‚Äî write to searchable memory (Supabase embeddings) so retrieval surfaces them automatically
10. **Sam can self-deploy**: No need for Johan/SSH ‚Äî send instructions via A2A or Telegram, agent runs them

## Notion Pages Created
- üîß Feb 17 ‚Äî Consent Logging, Utility Anti-Bias, Sam Deploy (30a7a723-4ce4-81f7-8ec4-c810c18a9c95)
- üï∏Ô∏è Knowledge Graph Ontology v1.0 ‚Äî Cross-Client Intelligence (30a7a723-4ce4-81b0-90c5-fb7a34784d46)

## Sam Deploy Confirmed
- Bridget sent deploy instructions directly to Sam
- Sam self-deployed: identity fixed (Sam üõ†Ô∏è), field-security.json loaded, all 5 security layers active
- Key learning: agents can self-deploy via instructions ‚Äî no human SSH needed

## Git Commits Today
- `2235b2e` ‚Äî consent logging + client-scoped storage
- `a74d887` ‚Äî utility scoring with anti-bias mechanisms
- `93550ec` ‚Äî KG ontology v1 + daily log updates
- `a07839c` ‚Äî knowledge graph infrastructure (graph engine + extraction)
- `c8a7ef8` ‚Äî scoped KG (one graph, filtered views)

### Git feature ‚Äî 09:41
- **Commit:** `1131b9c` on `workspace`
- **Message:** feat: KG query CLI ‚Äî stats, people, features, bugs, about, client, who-requested, decisions
- **Files:** 1 changed
- **Stats:**  1 file changed, 261 insertions(+)
- **Changed:** skills/knowledge-graph/scripts/query.cjs

### Git feature ‚Äî 11:07
- **Commit:** `31b606a` on `workspace`
- **Message:** feat: add stakes-gating + bulk file rules to SOUL.md
- **Files:** 1 changed
- **Stats:**  1 file changed, 9 insertions(+)
- **Changed:** SOUL.md

### Git feature ‚Äî 11:09
- **Commit:** `ddbf861` on `workspace`
- **Message:** feat: surface anti-bias scoring in verbose output (decay, novelty, epsilon)
- **Files:** 1 changed
- **Stats:**  1 file changed, 13 insertions(+), 2 deletions(-)
- **Changed:** skills/memory-retriever/scripts/search-supabase.cjs

## KG Schema v2 ‚Äî Deep Research + Extraction Testing (10:00 AM - 12:30 PM ET)

### Schema v2 Proposal
- Deep research sub-agent ran: Zep/Graphiti, Microsoft GraphRAG, CRM KGs analyzed
- **Trimmed 16 ‚Üí 10 entity types**: Merged Problem/Solution/Pattern ‚Üí "Topic", Goal ‚Üí Task, dropped Location/Document/Metric as standalone nodes
- **12 core relationship types** with bi-temporal edges (valid_from/to + created_at/invalidated_at)
- Confidence + provenance on all edges (stated/extracted/inferred/manual)
- PostgreSQL confirmed viable: recursive CTEs, RLS multi-tenancy, pgvector embeddings
- Anti-patterns documented: entity type explosion, orphan nodes, no temporal invalidation, no provenance
- Full research: `research/kg-schema-deep-research.md`, proposal: `research/kg-schema-proposal-v2.md`
- Notion page updated with v2 findings

### Extraction Prompt Testing (3 iterations on Sam's real Click Seguros conversations)
- **v1**: 25 entities, 22 rels ‚Äî entity resolution broken (Javier + Javier Mitrani separate), noise (ChatGPT/GPT-4/OpenAI as entities), wrong agent relationship (Sam WORKS_AT Click Seguros)
- **v2**: 27 entities, 22 rels ‚Äî fixed agent ASSIGNED_TO vs WORKS_AT, added Preferences/Decisions, still had dedup issues
- **v3**: 14 entities, 13 rels ‚Äî ‚úÖ all entity resolution correct (RuntyAxis‚ÜíEder, Jaime‚ÜíJimmy Mitrani, etc), clean contact info, temporal decision handling, minimal noise
- Key finding: passing **known entities list** to extraction prompt eliminates most dedup issues
- Gemini Flash cost: ~$0.001 per 10KB chunk

### Question-Driven Schema Refinement
- Bridget: "reverse engineer ‚Äî dream up questions we want to answer"
- 8 NOW questions (engagement, first requests, churn prediction, capability gaps, adoption per org)
- 7 DEEP RESEARCH questions (industry pain points, predictive onboarding, ROI attribution, collective intelligence)
- Recommendation: keep 10 entity types, add 2 relationships (LED_TO, SIMILAR_TO), use properties for sentiment/engagement/outcomes
- No new entity types needed ‚Äî properties on existing types + 2 new relationship types cover all 15 questions

## Sam's PDF Problem Investigated
- Javier uploaded 16 PDFs (insurance policies) and Sam only processed 3-4
- Root cause analysis from Sam's conversation logs:
  - PDFs came in as JPGs (Telegram converts), requiring vision/OCR ‚Äî slower
  - Agent was juggling 4 users simultaneously (Javier, Jimmy, Suzanne, Bridget)
  - Messages queued (`[Queued messages while agent was busy]`) during processing
  - Sam confirmed 13 saved (not 16) ‚Äî possible Telegram upload failures for 3
- **Image capacity test**: Claude handles 10 images in parallel per turn, 95-100% accuracy, zero hallucinations, ~1600 tokens per 800x600 image
- **Fix**: Added SOUL.md rule: "If 3+ files arrive fast, say 'Processing all of them' once. Don't respond per file."
- OpenClaw already has `collect` mode queue ‚Äî no infra changes needed

## Team Deploy: Stakes-Gating + Anti-Bias Retrieval
- Wrote deploy instructions for full team
- Steps: git pull skills, create learning dirs, add to SOUL.md + HEARTBEAT.md
- Stakes-gating: behavioral filter ("what was at risk?") ‚Äî stops 87% noise
- Anti-bias retrieval: verbose output now shows `[anti-bias: recency:+X%, novelty:+X%]` per result
- Sybil installed on self (commit `31b606a`)
- Sam + Saber confirmed installed
- Fixed: anti-bias scores were running but not visible in verbose output (commit `ddbf861`)

## A2A Routing Bugs Fixed
- **Bug 1**: `_config.sh` hardcoded Sybil's agent ID as default ‚Äî all agents became Sybil unless overridden
  - Fix: reads from `~/.openclaw/a2a/config.json` now (commit `41c55cc`)
- **Bug 2**: Saber + Santos not in resolve_agent_id routing table
  - Fix: added both UUIDs (commit `b326747`)
- **Bug 3**: Two relay instances exist ‚Äî I was sending to wrong one
  - `a2a-bjs-internal-skill-production.up.railway.app` (dead, nobody connected)
  - `a2a-bjs-internal-skill-production-f15e.up.railway.app` (active, Sam+Sage online)
  - Fix: updated config to -f15e (commit `a77c52e`)
- **Bug 4**: Sam's UUID wrong in routing table (2248 vs 28f6) ‚Äî reverted to relay-registered ID (commit `610bfde`)
- **A2A message truncation**: Found in daemon `a2a-daemon.js` line 330: `message.content.slice(0, 2000)` ‚Äî hardcoded 2KB limit. Saber's brand voice write-up got truncated. Fix TBD ‚Äî options: raise limit, or save large messages to file + send link.
- Santos + Saber showed offline on -f15e relay ‚Äî may need relay URL updated in their configs too

## Saber's Learning System Noise
- 65 "decisions" logged, only 8 real learnings (87% noise)
- 9 procedure candidates: 8 are activity logs (smb-crm, feature, skill-registry, etc), only "creativity" has transferable knowledge
- Recommendation: archive 8 to work-history/, keep creativity in promotion pipeline
- Saber self-identified the noise ‚Äî good sign for self-awareness
- Stakes-gating deployed to prevent future noise
