# 2026-02-19


### Pre-Compaction Snapshot (2026-02-19 04:00:48 UTC)
_Saved before context compaction to prevent memory loss._

Vulkimi cloud agent setup session - Anthropic token rotation fixed, GitHub access configured, Supabase migration pending

## Session: Feb 18-19 Late Night (Bridget)

### Anthropic Token Rotation ‚Äî FINALLY WORKING ‚úÖ
After many failed attempts, got Opus working with OAuth token (`sk-ant-oat01...`). The trap was 4 different files with 4 different formats:
- `auth-profiles.json`: `type: "token"`, field: `token`
- `auth.json`: `type: "api_key"`, field: `key` (yes, different!)
- `openclaw.json`: `mode: "token"` in auth.profiles
- **CRITICAL**: Reset `errorCount`, `cooldownUntil`, `failureCounts` in usageStats

Saber provided the working template. Delete and rebuild auth files from scratch if stuck.

### Vulkimi Deployment ‚Äî 95% Complete üåã
First cloud field agent on Railway (`vulkimi-production.up.railway.app`):
- ‚úÖ Setup script (IDENTITY, SOUL, memory/core files)
- ‚úÖ GitHub access (skills, vulkn-field-template, a2a-protocol-skill)
- ‚úÖ A2A connected ‚Äî sent/received test messages
- ‚úÖ Cron jobs configured (auto-update, memory guardian, nightly report, skills sync)
- ‚úÖ Magic setup (AGENTS.md, USER.md, HEARTBEAT.md)
- ‚úÖ Company knowledge + agent wisdom injected
- ‚è≥ Supabase migration ‚Äî waiting on DB password for `apyinhgahnmtphndbwij`
- ‚è≥ OpenAI/Gemini keys ‚Äî placeholders in rag/.env

### Sam Field Report Bug ‚Äî FIXED ‚úÖ
Reports were treating document chunks (`landing-page-en.md [1`, `customers.md [2`) as users. Added `INGESTION_PATTERNS` filter to `remote-analyze.cjs`. Pushed to skills repo. Sam needs to `git pull`.

### Saber Memory Infrastructure ‚Äî FIXED ‚úÖ
Issues: wrong agentic-learning path, missing Supabase creds, no thread archival cron.
Fixed: symlink, added BJS Supabase keys + OpenAI to rag/.env, added crons.
Still pending: memory-api skill not installed, Google OAuth needs Mac auth flow.

### Skills Repo Cleanup ‚úÖ
Removed duplicate `agentic-learning/` at root (36 files via API). Correct version is `skills/agentic-learning/` with extract-insights.cjs, outcome-checker.cjs, etc.

### Research Tasks Backlog ‚ö†Ô∏è
31 tasks stuck in "acknowledged" (16 Saber, 15 Sam), all 4-5+ days overdue. Monitor doesn't flag acknowledged as overdue. Consider adjusting filter or checking capacity.

### Notion Changelog
Logged: skills repo cleanup, Saber memory fix, Sam field report fix (earlier).

### Key Learnings
- OAuth tokens work but need exact format in 4 places
- `raw.githubusercontent.com` doesn't work for private repos even with token ‚Äî use GitHub API
- Vulkimi's GitHub user: `vulkimitesteo-vulkn`
- Git credential caching can stick to wrong account ‚Äî `git credential reject` + `gh auth setup-git`
- Don't share real client names/stories in demos (Suzanne ‚Üí "a nonprofit founder")

---

### Pre-Compaction Snapshot #2 (2026-02-19 05:12 UTC)

Session continued with Saber memory system deep dive. Key additions:

**Saber 5-Issue Diagnostic:**
1. Memory API disabled ‚Äî skill not installed
2. Path mismatches ‚Äî `skills/skills/agentic-learning/scripts/` vs correct `skills/agentic-learning/scripts/`
3. Dead Supabase sync ‚Äî missing SUPABASE_URL, SUPABASE_ANON_KEY
4. No thread cleanup ‚Äî archive-threads.cjs cron missing
5. Basic boot memory ‚Äî no context-aware loading

**Status at Compaction:**
- Vulkimi: 95% operational (missing DB password for Supabase migration)
- Saber: Memory system fixed, pending Google OAuth (requires Mac auth flow)
- Sam: Offline, needs `git pull` for field report fix (commit `a87ec24`)
- Sage: Still DOWN

**Next Actions:**
1. Get Vulkimi Supabase DB password from Johan
2. Ping Sam to pull skills repo update
3. Monitor Saber memory system recovery

### Git commit ‚Äî 07:32
- **Commit:** `423b901` on `workspace`
- **Message:** RECOVERY: restore 453 files lost during botched rebase on Feb 19 00:26
- **Files:** 460 changed
- **Stats:**  460 files changed, 88343 insertions(+), 2 deletions(-)

## Rebase Incident ‚Äî 00:26 AM
- **Root cause:** `git pull --rebase` ‚Üí `git reset HEAD~1` ‚Üí selective recommit dropped 453 files
- **Lost:** Daily logs (Feb 4-19), A2A threads, research data, Sam reports, security events, deploy packages
- **Recovery:** All files restored from rebased commit `5382092` ‚Üí committed as `423b901`
- **Prevention:** Added git safety rules to AGENTS.md + field template
- **Not a systemic agent bug** ‚Äî git misuse, not memory infrastructure failure

## Memory Workflow Instructions Sent via A2A
- Saber ‚úÖ, Sam ‚úÖ, Santos ‚úÖ
- Instructions: pull skills repo, read WORKFLOW_AUTO.md, use smart-trigger + surprise-score

## Sam Pending Items
1. Skills pull (`a87ec24` ‚Äî field report filter fix)
2. Conversation sync cron (unconfirmed from Feb 17)
3. Credential storage flow (no policy yet)

## Notion Changelog Reviewed
- 14 entries on Feb 18, 5 entries on Feb 19
- 1 pending: field report fix needs Sam to pull

### Git commit ‚Äî 09:09
- **Commit:** `af43213` on `workspace`
- **Message:** recovery + dedup fix + git safety rules (clean, no secrets)
- **Files:** 448 changed
- **Stats:**  448 files changed, 84972 insertions(+), 4 deletions(-)

### Git commit ‚Äî 09:10
- **Commit:** `15460d7` on `workspace`
- **Message:** recovery + dedup fix + git safety rules (clean, no secrets)
- **Files:** 448 changed
- **Stats:**  448 files changed, 84979 insertions(+), 4 deletions(-)

### Git commit ‚Äî 09:10
- **Commit:** `dbfd668` on `workspace`
- **Message:** recovery + dedup fix + git safety rules (clean, no secrets)
- **Files:** 448 changed
- **Stats:**  448 files changed, 84988 insertions(+), 4 deletions(-)

### Git commit ‚Äî 09:10
- **Commit:** `426b97d` on `workspace`
- **Message:** recovery + dedup fix + git safety rules (clean, no secrets)
- **Files:** 436 changed
- **Stats:**  436 files changed, 82749 insertions(+), 4 deletions(-)

### Git commit ‚Äî 09:10
- **Commit:** `80afa6f` on `workspace`
- **Message:** recovery + dedup fix + git safety rules (clean, no secrets)
- **Files:** 435 changed
- **Stats:**  435 files changed, 82477 insertions(+), 4 deletions(-)

### Git docs ‚Äî 09:16
- **Commit:** `a7691d9` on `workspace`
- **Message:** docs: Vulkimi dual Supabase setup guide (client DB + BJS shared DB)
- **Files:** 1 changed
- **Stats:**  1 file changed, 71 insertions(+)
- **Changed:** deploy/vulkimi/DUAL-SUPABASE-SETUP.md

### Git feature ‚Äî 09:44
- **Commit:** `87204f3` on `workspace`
- **Message:** feat: A2A task tracking system ‚Äî send/ack/status with Supabase
- **Files:** 3 changed
- **Stats:**  3 files changed, 504 insertions(+)
- **Changed:** rag/a2a-task-ack.cjs,rag/a2a-task-send.cjs,rag/a2a-task-status.cjs

## Morning Session with Johan (7:00 AM - 10:19 AM ET)

### Rebase Incident ‚Äî 453 Files Lost & Recovered
- **Root cause:** `git pull --rebase` ‚Üí `git reset HEAD~1` ‚Üí selective recommit dropped 453 files
- **Recovery:** All files restored from rebased commit `5382092` ‚Üí committed as `423b901`
- **Prevention:** Added git safety rules to AGENTS.md + field template
- **GitHub push protection** blocked push due to secrets in recovered files ‚Äî had to scrub ~15 files with OAuth/API keys, final push as `80afa6f`

### Cron Job Overhaul ‚Äî Clean Ownership Model
**Major restructuring of all agent cron jobs to reduce token burn and eliminate overlap:**

**Key changes:**
- ALL cron jobs switched to Sonnet (were running on Opus ‚Äî massive waste)
- Memory Sync: 48x/day ‚Üí 2x/day
- Product Insights: 4x/day ‚Üí 1x/day (moved to Saber)
- Product Monitoring + KG: 4x/day ‚Üí 1x/day (moved to Saber)
- Nightly Field Report: moved to Santos
- Agentic Learning Review: moved to Saber
- Weekly Learning Synthesis: moved to Saber
- Research Task Monitor: merged into daily scan

**New ownership:**
- **Sybil:** Research, memory infra, security (11 active jobs)
- **Sam:** Client service, 3x/day sync (12PM, 5PM, 10PM), nightly report, learning
- **Santos:** Escalations 3x/day (30min after Sam syncs), founder briefings, agent health
- **Saber:** Product intelligence, KG, learning system oversight, weekly synthesis

**Data flow design:** Sam writes ‚Üí 30 min later ‚Üí Santos reads (event-driven, not arbitrary intervals)

**All agents now on learning pipeline:** daily extraction + weekly auto-promotion + weekly boot memory audit

**Notion docs created:**
- "Agent Cron Jobs ‚Äî Master Schedule" under BJS LABS (page `30c7a723-4ce4-8162-b765-dbb03b284e20`)
- Field Agent Template with copy-paste cron commands
- Logged to BJS Daily Changelog

### Memory Sync Cost Analysis
- `conversations` table: 7,252 rows, `documents` table: 1,449 chunks (Sybil 381, Saber 250, Sam 204, Santos 165)
- Embedding cost: ~$0.003 per full sync (essentially free)
- Real cost was agent turns (Opus) to run cheap Node scripts ‚Äî now fixed with Sonnet

### Conversation Sync Dedup Fix
- **Bug:** sync script re-uploaded all messages when session file mtime changed
- **Fix:** Track message count offset per session, only send new messages (commit `754f7c3`)
- Santos confirmed 846 dupes at 4AM ‚Äî this should fix it

### A2A Task Tracking System ‚Äî Built & Tested
- **Supabase table:** `agent_tasks` ‚Äî tracks SENT ‚Üí DELIVERED ‚Üí ACKNOWLEDGED ‚Üí COMPLETED
- **Scripts:** `a2a-task-send.cjs`, `a2a-task-ack.cjs`, `a2a-task-status.cjs`
- **Broadcast support:** parent task + per-agent child tasks with rollup (e.g. "2/3 completed")
- **Overdue detection:** configurable timeout per task (default 2h)
- **Enforcement plan:** Medium ‚Äî HEARTBEAT checks + nightly report accountability
- **Commit:** `87204f3`, pushed

### Vulkimi Status
- Railway service returns 503 ‚Äî "Gateway did not become ready in time"
- Need `SETUP_PASSWORD` (different from gateway token) to access debug console
- Dual Supabase setup guide written (`deploy/vulkimi/DUAL-SUPABASE-SETUP.md`)
- BJS Supabase keys ready, cron commands prepped, waiting for Vulkimi to come online

### Sam Issues (from Santos's report)
- "Unknown Client" ‚Äî `client_id`/`user_name` null in all conversation rows. Sync script doesn't extract client names.
- UUID mismatch ‚Äî `team.md` may still have wrong UUID from identity contamination
- Dedup fix confirmed working (0 dupes today, 69 clean rows)

### Gemini API Fix
- Saber reported 401 on KG extraction ‚Äî not an auth issue
- Model names changed: `gemini-2.5-flash-preview-05-20` ‚Üí `gemini-2.5-flash` (preview graduated to stable)

### Token Burn Analysis
- Our conversation: 245+ Opus turns, ~1.2MB transcript ‚Äî biggest single cost
- All cron jobs were on Opus ‚Äî now ALL switched to Sonnet
- Memory API Refresh was running 6x/day on Opus ‚Äî now Sonnet
- Estimated 80%+ reduction in cron token spend going forward

### Pending
- [ ] Vulkimi: get SETUP_PASSWORD, bring online, dual Supabase setup
- [ ] A2A task enforcement: send instructions to all agents (task protocol in AGENTS.md + HEARTBEAT.md)
- [ ] Notion: A2A task dashboard (tab on A2A homepage or Notion page)
- [ ] Fix sync-conversations.cjs to extract client names
- [ ] Sam: verify team.md UUID, client name mapping
- [ ] Saber: update Gemini model names, switch all crons to Sonnet
- [ ] Santos: add overdue task check to escalation cron
